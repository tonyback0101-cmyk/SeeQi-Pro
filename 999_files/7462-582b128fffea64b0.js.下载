"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7462,3413],{38813:function(e,t,r){r.d(t,{c:function(){return n},k:function(){return l}});let n=500,l="https://cdn.openart.ai/assets/openart_og_image_20250509.png"},57783:function(e,t,r){var n=r(52676),l=r(75271),i=r(66266),o=r(97792),a=r(11955),s=r(56407),c=r(80110),u=r(72660),d=r(22988),p=r(35523),h=r(68261),x=r(43807),m=r(43246),g=r(45138),b=r(77379),f=r(29984),v=r(75733),j=r(29678),y=r(10986),Z=r(74222),C=r(90043),w=r(34547),k=r(72509),P=r(24088),I=r(57671),S=r(27806),E=r(46973),z=r(86660),R=r(16585);t.Z=e=>{let{open:t,onClose:r,setPrompt:A,showCreateButton:D=!0}=e,F=(0,i.useRouter)(),{enqueueSnackbar:U}=(0,y.Ds)(),W=(0,z.Z)("up","md"),{mutate:B,isLoading:N}=(0,I.AY)(),{status:M}=(0,j.useSession)(),_="authenticated"===M,[H,T]=(0,l.useState)(!1),[L,O]=(0,l.useState)(),[G,q]=(0,l.useState)("joy-caption"),[V,$]=(0,l.useState)(""),Q=`${P.I}?prompt=${encodeURIComponent(V)}`,[K,X]=(0,l.useState)(!1),Y=(0,l.useRef)(null),J=(0,l.useRef)(!1),ee=()=>{r()};(0,l.useEffect)(()=>{J.current=!1,X(!1)},[]);let et=async e=>{if(!_)return F.push("/signin");if(e){X(!1),O({file:e});let t=new FormData;t.append("file",e),T(!0),await E.ZP.post("/media/upload_image",t,{headers:{"Content-Type":"multipart/form-data"}}).then(async e=>{if(200===e.status&&e.data){let{imageUrl:t}=e.data;er(t,!0)}}).finally(()=>{T(!1)})}else O(void 0)},er=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];B({image:e,is_tmp_image:t,model:G},{onSuccess:e=>{var t;(null==e?void 0:null===(t=e.caption)||void 0===t?void 0:t.length)>0&&!J.current&&($(e.caption),R.B("asset_created",{creation_source:"app",app_name:"image_to_text",image_num:1}))}})},{UploadContextMenu:en,handleMenuOpen:el}=(0,k.w)({onChange:e=>{if(e&&e.length>0){let t=e[0];O({preview:t}),T(!0),er(t),T(!1)}},onClickUpload:()=>{var e;return null===(e=Y.current)||void 0===e?void 0:e.triggerInputClick()},maxSelectionCount:1});(0,v.Z)(()=>{(null==L?void 0:L.file)&&et(L.file)},[G]);let ei=N||!V;return(0,n.jsxs)(o.Z,{open:t,fullWidth:!0,maxWidth:"md",scroll:"paper",onClose:ee,children:[(0,n.jsx)(a.Z,{mb:1,children:(0,n.jsx)(s.Z,{direction:"column",children:(0,n.jsx)(c.Z,{variant:"h4",children:"Image to Prompt"})})}),(0,n.jsxs)(u.Z,{sx:{width:"100%"},children:[!_&&(0,n.jsxs)(s.Z,{direction:"column",alignItems:"center",justifyContent:"center",spacing:1,sx:{my:2},children:[(0,n.jsx)(w.Z,{title:"Sign Up"}),(0,n.jsx)(c.Z,{variant:"caption",fontWeight:"bold",children:"⚠️ You need to sign up to use this feature."})]}),(0,n.jsxs)(s.Z,{direction:W?"row":"column",sx:{width:"100%"},spacing:2,children:[(0,n.jsxs)(s.Z,{direction:"column",alignItems:"center",justifyContent:"center",children:[(0,n.jsx)(d.Z,{sx:{cursor:"pointer"},children:(0,n.jsx)(C.Z,{ref:Y,isUploading:H,file:L,bordered:!1,title:"Drag and drop, upload, or select from history",sx:{borderRadius:0,margin:0,width:W?"300px":"250px",height:W?"300px":"250px"},dropZoneSx:{borderRadius:0},onDrop:e=>{e&&e.length>0&&et(e[0])},onDelete:()=>{et(null)},onAreaClick:e=>{if(!_)return F.push("/signin");e.preventDefault(),el(e)},zoomable:!0,deletable:!0})}),en,(0,n.jsxs)(p.Z,{sx:{mx:1,mt:1},size:"small",children:[(0,n.jsx)(h.Z,{id:"model-select-label",children:"Model"}),(0,n.jsxs)(x.Z,{disabled:N,labelId:"model-select-label",id:"model-select",value:G,size:"small",label:"Model",sx:{minWidth:"280px"},onChange:e=>{q(e.target.value)},children:[(0,n.jsx)(m.Z,{value:"joy-caption",children:(0,n.jsx)(c.Z,{variant:"body2",children:"Joy Caption"})}),(0,n.jsx)(m.Z,{value:"gpt-4o-mini",children:(0,n.jsx)(c.Z,{variant:"body2",children:"GPT-4o-mini"})}),(0,n.jsx)(m.Z,{value:"florence",children:(0,n.jsx)(c.Z,{variant:"body2",children:"Florence"})})]})]})]}),(0,n.jsxs)(s.Z,{direction:"column",sx:{width:"100%"},spacing:2,children:[(0,n.jsx)(d.Z,{children:(0,n.jsx)(g.Z,{sx:{mt:1},label:N&&!K?"Generating prompt...":"",fullWidth:!0,disabled:N?!K:null,variant:"outlined",multiline:!0,minRows:W?10:3,placeholder:"Upload an image to generate a text prompt",value:V,onChange:e=>$(e.target.value),inputProps:{maxLength:1024},helperText:(0,n.jsxs)(c.Z,{variant:"caption",component:"span",textAlign:"right",sx:{width:"100%",display:"inline-block"},children:[V.length," / 1024"]})})}),(0,n.jsxs)(s.Z,{direction:"row",children:[(0,n.jsx)(b.Z,{variant:"contained",disabled:ei,className:"oa-button-primary",onClick:()=>{A?(A(V),ee()):(U("Prompt has been copied!",{variant:"success"}),navigator.clipboard.writeText(V))},startIcon:N?(0,n.jsx)(f.Z,{size:18}):(0,n.jsx)(S.IcBaselineContentCopy,{size:18,sx:{color:ei?"disabled":"#FBFBFD"}}),"aria-label":"Copy prompt",sx:{flex:1,mr:1},children:N?"Generating prompt...":A?"Use Prompt":"Copy Prompt"}),D?(0,n.jsx)(Z.Z,{disabled:ei,href:Q,openInNewTab:!0}):null]})]})]}),(0,n.jsx)(s.Z,{direction:"row",sx:{mt:4},children:(0,n.jsx)(b.Z,{variant:"text",onClick:ee,sx:{width:"100%"},children:"Close"})})]})]})}},79409:function(e,t,r){r.d(t,{o:function(){return g}});var n=r(52676),l=r(75271),i=r(56407),o=r(80110),a=r(43807),s=r(43246),c=r(22988),u=r(46740),d=r(53778),p=r(7999),h=r(27806);let x=(0,u.F4)`
  0% { transform: rotate(0deg) scale(1); }
  25% { transform: rotate(-10deg) scale(1.15); }
  50% { transform: rotate(0deg) scale(1.2); }
  75% { transform: rotate(10deg) scale(1.15); }
  100% { transform: rotate(0deg) scale(1); }
`;function m(e){let{height:t,width:r}=e,l=r/t;return(0,n.jsx)(i.Z,{justifyContent:"center",alignItems:"center",sx:{width:18,height:18},children:(0,n.jsx)(c.Z,{sx:{boxSizing:"border-box",border:"2px solid white",width:l>1?"100%":`${18*l}px`,height:l>1?`${18/l}px`:"100%"}})})}let g=(0,l.forwardRef)((e,t)=>{let{value:r,lock:c,setLock:u,showLock:g,onChange:b,aspectRatios:f=[],disabled:v,showDefault:j=!0,showTitle:y=!0}=e,[Z,C]=(0,l.useState)(!1),w=(0,l.useRef)(null),k=()=>{!Z&&c&&g&&(C(!0),w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{C(!1)},500))};return(0,l.useImperativeHandle)(t,()=>({animateLockIcon:k})),(0,l.useEffect)(()=>()=>{w.current&&clearTimeout(w.current)},[]),(0,n.jsxs)(i.Z,{direction:"row",alignItems:"center",spacing:1,children:[y?(0,n.jsx)(o.Z,{variant:"editor-label1",whiteSpace:"nowrap",children:"Aspect Ratio"}):null,(0,n.jsxs)(a.Z,{id:"aspect-ratio-select","aria-label":"Aspect Ratio - Select the aspect ratio for your image",size:"small",disabled:v,value:f.some(e=>e.ratio===r)?r:"Default",onChange:e=>{let t=e.target.value;"Default"===t&&(t=f[0].ratio),b(t)},sx:{my:1,width:"100%"},children:[j?(0,n.jsx)(s.Z,{value:"Default",children:"Default"},"Default"):null,f.map(e=>{let t=(0,d.Z)(e),{ratio:r,name:l}=t,[a,c]=r.split(":").map(e=>Number.parseInt(e,10));return(0,n.jsx)(s.Z,{value:t.ratio,children:(0,n.jsxs)(i.Z,{width:"100%",direction:"row",alignItems:"center",spacing:1,children:[a&&a!==Number.NaN&&c&&c!==Number.NaN?(0,n.jsx)(m,{width:a,height:c}):null,(0,n.jsxs)(o.Z,{variant:"editor-span1",children:[l," (",r,")"]}),l?null:(0,n.jsxs)(o.Z,{variant:"editor-span1",sx:{display:"inline-block",ml:"auto!important"},children:["(",r??"",")"]})]})},(null==t?void 0:t.name)??t.ratio)})]}),g&&u?c?(0,n.jsx)(h.PhLockSimple,{"aria-label":"Aspect ratio is locked - Click to unlock",role:"button",tabIndex:0,sx:{backgroundColor:p.yS,color:p.ce,borderRadius:"4px",cursor:"pointer","&:hover":{opacity:.8},width:40,px:.5,height:24,animation:Z?`${x} 0.5s ease`:"none"},onClick:()=>null==u?void 0:u(!1),onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),null==u||u(!1))}}):(0,n.jsx)(h.PhLockSimpleOpen,{"aria-label":"Aspect ratio is unlocked - Click to lock",role:"button",tabIndex:0,sx:{width:40,height:24,px:.5,cursor:"pointer","&:hover":{opacity:.8}},onClick:()=>null==u?void 0:u(!0),onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),null==u||u(!0))}}):null]})})},12707:function(e,t,r){r.d(t,{zT:function(){return eA}});var n=r(52676),l=r(75271),i=r(42283),o=r(2396),a=r(84971),s=r(56407),c=r(45138),u=r(6721),d=r(97792),p=r(11955),h=r(80110),x=r(72660),m=r(8765),g=r(57783),b=r(83903),f=r(76039),v=r(65788),j=r(77379),y=r(22988);let Z="general-enhance",C=[{value:"warm",label:"Warm"},{value:"cool",label:"Cool"},{value:"vibrant",label:"Vibrant"},{value:"muted",label:"Muted"},{value:"dark",label:"Dark"},{value:"pastel",label:"Pastel"}],w=[{value:"realism",label:"Realism"},{value:"fantasy",label:"Fantasy"},{value:"anime",label:"Anime"},{value:"surrealism",label:"Surrealism"},{value:"photorealism",label:"Photorealism"},{value:"minimalism",label:"Minimalism"},{value:"pixel",label:"Pixel"},{value:"cartoon",label:"Cartoon"},{value:"vintage",label:"Vintage"},{value:"watercolor",label:"Watercolor"},{value:"baroque",label:"Baroque"},{value:"impressionism",label:"Impressionism"},{value:"ads-advertising",label:"Ads & Advertising"},{value:"artstyle-abstract",label:"Abstract"},{value:"ads-automotive",label:"Automotive"},{value:"ads-corporate",label:"Corporate"},{value:"ads-fashion editorial",label:"Fashion Editorial"},{value:"ads-food photography",label:"Food Photography"},{value:"ads-luxury",label:"Luxury"},{value:"ads-real estate",label:"Real Estate"},{value:"ads-retail",label:"Retail"},{value:"artstyle-abstract expressionism",label:"Abstract Expressionism"},{value:"artstyle-art deco",label:"Art Deco"},{value:"artstyle-art nouveau",label:"Art Nouveau"},{value:"artstyle-constructivist",label:"Constructivist"},{value:"artstyle-graffiti",label:"Graffiti"},{value:"artstyle-pointillism",label:"Pointillism"},{value:"artstyle-pop art",label:"Pop Art"},{value:"artstyle-psychedelic",label:"Psychedelic"},{value:"artstyle-renaissance",label:"Renaissance"},{value:"artstyle-steampunk",label:"Steampunk"},{value:"futuristic-biomechanical",label:"Biomechanical"},{value:"futuristic-cybernetic",label:"Cybernetic"},{value:"futuristic-futuristic",label:"Futuristic"},{value:"futuristic-retro futurism",label:"Retro Futurism"},{value:"futuristic-sci-fi",label:"Sci-Fi"},{value:"futuristic-vaporwave",label:"Vaporwave"},{value:"game-bubble bobble",label:"Bubble Bobble"},{value:"game-cyberpunk game",label:"Cyberpunk Game"},{value:"photo-silhouette",label:"Silhouette"},{value:"photo-film noir",label:"Film Noir"},{value:"papercraft-flat papercut",label:"Flat Papercut"},{value:"papercraft-collage",label:"Collage"},{value:"misc-tribal",label:"Tribal"},{value:"misc-stained glass",label:"Stained Glass"},{value:"misc-minimalist",label:"Minimalist"},{value:"misc-manga",label:"Manga"},{value:"misc-macabre",label:"Macabre"},{value:"misc-kawaii",label:"Kawaii"},{value:"misc-grunge",label:"Grunge"},{value:"misc-gothic",label:"Gothic"},{value:"misc-dystopian",label:"Dystopian"},{value:"misc-architectural",label:"Architectural"},{value:"game-zelda",label:"Zelda"},{value:"game-streetfighter",label:"Streetfighter"},{value:"game-strategy game",label:"Strategy Game"},{value:"game-rpg fantasy game",label:"RPG Fantasy Game"},{value:"game-retro arcade",label:"Retro Arcade"},{value:"game-pokemon",label:"Pokemon"},{value:"game-minecraft",label:"Minecraft"},{value:"game-mario",label:"Mario"},{value:"game-gta",label:"GTA"},{value:"game-fighting game",label:"Fighting Game"}],k=(0,l.forwardRef)(function(e,t){let{onOk:r}=e,[i,o]=(0,l.useState)(!1),[a,c]=(0,l.useState)(""),[u,d]=(0,l.useState)("");return(0,l.useImperativeHandle)(t,()=>({open:()=>o(!0),close:()=>o(!1)})),(0,n.jsxs)(v.Z,{anchor:"left",onClose:()=>o(!1),open:i,onOpen:()=>{},sx:{"& .MuiDrawer-paper":{width:"300px",padding:"20px",background:"#2A2A2A",height:"100%",overflowY:"auto"}},children:[(0,n.jsxs)(s.Z,{direction:"column",spacing:3,sx:{height:"100%",marginBottom:"20px"},children:[(0,n.jsxs)(s.Z,{direction:"row",spacing:2,alignItems:"center",children:[(0,n.jsx)(b.Z,{onClick:()=>{o(!1)}}),(0,n.jsx)(h.Z,{fontSize:18,fontWeight:500,children:"Prompt enhancer"})]}),(0,n.jsxs)(s.Z,{spacing:3,children:[(0,n.jsx)(h.Z,{fontSize:16,fontWeight:500,children:"Color Scheme"}),(0,n.jsx)(s.Z,{direction:"column",spacing:1,children:C.map(e=>(0,n.jsx)(j.Z,{variant:"contained",sx:{boxSizing:"border-box",width:"100%",backgroundColor:"background.paper",color:"text.primary","&:hover":{backgroundColor:"background.paper",color:"text.primary"},border:"1px solid",borderColor:a===e.value?"#0084FF":"background.paper"},onClick:()=>{if(a===e.value){c("");return}c(e.value)},children:e.label},e.value))})]}),(0,n.jsxs)(s.Z,{spacing:3,children:[(0,n.jsx)(h.Z,{fontSize:16,fontWeight:600,children:"Style"}),(0,n.jsxs)(s.Z,{direction:"column",spacing:1,children:[w.map(e=>(0,n.jsx)(j.Z,{variant:"contained",sx:{boxSizing:"border-box",backgroundColor:"background.paper",color:"text.primary","&:hover":{backgroundColor:"background.paper",color:"text.primary"},border:"1px solid",borderColor:u===e.value?"#0084FF":"background.paper"},onClick:()=>{if(u===e.value){d("");return}d(e.value)},children:e.label},e.value)),(0,n.jsx)(y.Z,{sx:{height:"60px"}})]})]})]}),(0,n.jsx)(y.Z,{sx:{position:"fixed",bottom:0,height:"60px",backgroundColor:"#2A2A2A"},children:(0,n.jsx)(j.Z,{variant:"contained",sx:{width:"260px"},onClick:()=>{null==r||r({colorScheme:a,style:u}),o(!1)},className:"oa-button-primary",startIcon:(0,n.jsx)(f.Z,{}),children:"Enhance prompt"})})]})});var P=r(76651),I=r(29984),S=r(92743),E=r(30159),z=r(75542),R=r(16301),A=r(82639),D=r(23187),F=r(56547),U=r(68170),W=r(39204),B=r(12853),N=r(97779),M=r(27806),_=r(38218),H=r(16585);let T=e=>{let{value:t,options:r,onChange:l}=e;return(0,n.jsx)(s.Z,{direction:"row",sx:{bgcolor:"#1E1E1E",borderRadius:"5px",overflow:"hidden",position:"relative"},children:r.map(e=>(0,n.jsxs)(y.Z,{sx:{px:2,py:.3,color:"white",cursor:"pointer",position:"relative",zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.20)"},onClick:t=>{l(e.value)},children:[(0,n.jsx)(h.Z,{variant:"editor-label1",fontWeight:t===e.value?"bold":"normal",children:e.label}),t===e.value&&(0,n.jsx)(W.E.div,{layoutId:"activeToggle",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3,type:"spring",stiffness:500,damping:30},style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"#0929F7",zIndex:-1}})]},e.value))})},L=e=>{let{options:t,autoEnhance:r,onAutoEnhanceChange:i}=e,[o,a]=(0,l.useState)(!1),c=(0,l.useRef)(null),{isMobile:u}=(0,N.j)(),d=(0,_.Xd)("prompt.enhance"),p=()=>{a(!1)},x=e=>{H.B("change-prompt-assistant-mode",{mode:e}),null==i||i(e)},m=e=>()=>{H.B("prompt_enhanced",{enhance_mode:e.value}),null==e||e.onclick(),p()},g=void 0!==r&&i,b=u?"350px":"280px";return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.Z,{ref:c,direction:"row",alignItems:"center",justifyContent:"center",spacing:.5,height:"100%",width:"100%",onClick:()=>{a(!o)},children:[g?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(B.r,{checked:"on"===r,onChange:e=>{e.stopPropagation();let t=e.target.checked?"on":"off";H.B("change-prompt-assistant-mode",{mode:t}),null==i||i(t)},onClick:e=>e.stopPropagation(),value:r}),(0,n.jsxs)(h.Z,{variant:"editor-label1",children:["Auto Enhance:"," ",(0,n.jsx)("span",{style:{fontWeight:"bold",minWidth:"24px",display:"inline-block",textAlign:"center"},children:"on"===r?"ON":"OFF"})]})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.Z,{fontSize:"small"}),(0,n.jsx)(h.Z,{variant:"editor-label1",children:"Enhance prompt"})]}),(0,n.jsx)(S.Z,{fontSize:"small"})]}),(0,n.jsx)(E.Z,{anchorEl:c.current,open:o,sx:{zIndex:1400},role:void 0,transition:!0,placement:"bottom",children:e=>{let{TransitionProps:i,placement:o}=e;return(0,n.jsx)(z.Z,{...i,style:{transformOrigin:"bottom"===o?"center top":"center bottom",width:b},children:(0,n.jsx)(R.Z,{sx:{width:"280px",borderRadius:"10px",border:"1px solid #313131",backgroundColor:"#151718",boxShadow:"0px 4px 6px 0px rgba(0, 0, 0, 0.10), 0px 10px 15px 0px rgba(0, 0, 0, 0.10)"},children:(0,n.jsx)(U.d,{onClickAway:p,children:(0,n.jsxs)(s.Z,{children:[g?(0,n.jsxs)(n.Fragment,{children:[" ",(0,n.jsxs)(s.Z,{p:1,direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,n.jsxs)(s.Z,{spacing:.3,direction:"row",alignItems:"center",children:[(0,n.jsx)(h.Z,{fontSize:u?16:12,fontWeight:500,color:"white",children:"Auto Prompt Enhance"}),(0,n.jsx)(A.Z,{title:"In auto mode, prompts are enhanced for half of your generations. In on mode, prompts are always enhanced. In off mode, prompts are not enhanced.",placement:"top",children:(0,n.jsx)(M.PhInfo,{sx:{height:"18px !important",width:"18px !important",color:"rgba(255, 255, 255, 0.6)"}})})]}),(0,n.jsx)(T,{value:r||"off",options:[{value:"on",label:"ON"},{value:"off",label:"OFF"}],onChange:x})]}),(0,n.jsx)(D.Z,{flexItem:!0})," "]}):null,(0,n.jsxs)(s.Z,{p:1,pt:0,children:[(0,n.jsxs)(s.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{height:"32px"},children:[(0,n.jsx)(h.Z,{variant:"editor-label1",color:"white",children:"Manual Options:"}),(0,n.jsxs)(h.Z,{variant:"editor-label2",color:"#3FDD78",fontWeight:500,children:[d," credit each"]})]}),(0,n.jsx)(D.Z,{flexItem:!0}),t.map((e,r)=>(0,n.jsxs)(l.Fragment,{children:[(0,n.jsxs)(F.Z,{disabled:e.disabled,onClick:m(e),sx:{display:"flex",justifyContent:"space-between",alignItems:"center",height:"45px",width:"100%",px:1,transition:"background-color 0.2s ease","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:[(0,n.jsxs)(s.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,n.jsx)(y.Z,{sx:{color:"#4459DD",display:"flex",alignItems:"center"},children:e.icon}),(0,n.jsx)(h.Z,{variant:"editor-label1",color:"white",children:e.label})]}),(0,n.jsx)(y.Z,{sx:{color:"white"},children:(0,n.jsx)(S.Z,{fontSize:"small",sx:{transform:"rotate(-90deg)"}})})]}),r!==t.length-1&&(0,n.jsx)(D.Z,{})]},e.value))]})]})})})})}})]})};var O=r(31664),G=r(60588),q=r(54022),V=r(40187),$=r(89228),Q=r(52816),K=r(25278),X=r(24325),Y=r(81192),J=r(19082),ee=r(92926),et=r(45468),er=r(19005),en=r(46973);let el=async e=>(await en.ZP.post("common/prompt",e)).data,ei=(0,en.py)(el,{onSuccessWithQueryClient:(e,t)=>{e.invalidateQueries([er.uE])}});var eo=r(8468);class ea{get list(){var e;return(null===(e=this.store)||void 0===e?void 0:e.list)??[]}attachQuery(e){this.queryFn=e}async next(e){return this.after?this.after:await this.query(e??this.currentParams)}async query(e){H.B("prompt_enhanced",{enhance_mode:"more"});let t=await this.queryFn(e);(0,eo.gf)().invalidateQueries([er.uE]);let r=new ea({list:t.map(e=>new et.NL({prompt:e.prompt,is_generated:!0}))});return r.before=this,this.after=r,r.currentParams=e,r}constructor(e=null){this.before=null,this.after=null,this.store=e}}let es=(0,Y.cn)(new ea),ec=(0,Y.cn)(!1),eu=e=>{let[t,r]=(0,J.KO)(es),[n,l]=(0,J.KO)(ec),[i]=ei({onError(){l(!1)}});t.attachQuery(i);let o=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;l(!0),r(await t.next(e)),l(!1)},a=async()=>{t.before&&r(t.before)},s=async()=>{(0,ee.Z)(t.currentParams,e)||n||(r(new ea),l(!0),r(await t.query(e)),l(!1))},c=!(0,ee.Z)(t.currentParams,e);return{data:t.list,loading:n,next:o,forward:a,start:s,isNew:c}};var ed=r(7999);let ep=(0,l.memo)(function(e){let{onClose:t,isMobile:r,sx:l,onSelect:i,dealWithDisplayPrompt:o}=e,{data:a,next:c,loading:u}=eu(null);return(0,n.jsx)(y.Z,{sx:l,children:(0,n.jsxs)(s.Z,{direction:"column",spacing:2,minHeight:r?0:462,children:[u?(0,n.jsxs)(s.Z,{direction:"row",width:"100%",alignItems:"center",spacing:1,children:[(0,n.jsx)(I.Z,{size:24,sx:{color:ed.tE}}),(0,n.jsx)(h.Z,{variant:"editor-label1",children:"Generating"})]}):(0,n.jsxs)(s.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,n.jsx)(h.Z,{variant:"editor-label1",sx:{cursor:"default"},children:"Enhanced prompts"}),(0,n.jsx)(q.default,{sx:{color:"#fff",cursor:"pointer"},onClick:()=>{null==t||t()}})]}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)($.Z,{sx:{m:0,p:0},children:(0,n.jsx)(X.Z,{children:a.map((e,t)=>(0,n.jsx)(Q.Z,{sx:{mb:t===a.length-1?0:1},children:(0,n.jsx)(eh,{prompt:e.value,onSelect:i,dealWithDisplayPrompt:o})},e.value))})}),a.length>0&&(0,n.jsx)(j.Z,{variant:"outlined",children:(0,n.jsxs)(s.Z,{direction:"row",alignItems:"center",spacing:.2,onClick:()=>c(),children:[(0,n.jsx)(V.Z,{sx:{color:ed.tE}}),(0,n.jsxs)(h.Z,{variant:"editor-label1",children:["Regenerate (",3," credits)"]})]})})]})]})})}),eh=e=>{let{prompt:t,onSelect:r,dealWithDisplayPrompt:l}=e;return(0,n.jsx)(K.ZP,{sx:{p:0,m:0},children:(0,n.jsxs)(s.Z,{direction:"column",sx:{background:"#1F1F1F",borderRadius:"10px",padding:"12px",border:"1px solid #313131"},spacing:1,children:[(0,n.jsx)(h.Z,{variant:"editor-label1",dangerouslySetInnerHTML:{__html:l(t)}}),(0,n.jsx)(j.Z,{sx:{backgroundColor:ed.tE,color:"#fff","&:hover":{backgroundColor:ed.tE,color:"#fff"},fontWeight:600},variant:"contained",onClick:()=>{null==r||r(t)},children:(0,n.jsx)(h.Z,{variant:"editor-label1",children:"Select"})})]})})},ex=e=>{let{recentUserInputPrompt:t,recentUserInputDescribe:r,setPrompt:i,dealWithDisplayPrompt:o}=e,[a,c]=(0,l.useState)(!1),u=(0,l.useRef)(null),[d,p]=(0,l.useState)(0),[x,m]=(0,l.useState)(0),{start:g,isNew:b}=eu({prompt:t,num_return_sequences:3,model:Z,...r});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.Z,{ref:u,direction:"row",alignItems:"center",justifyContent:"center",spacing:.5,height:"100%",width:"100%",padding:"0",onClick:()=>{var e;g();let t=null===(e=u.current)||void 0===e?void 0:e.getBoundingClientRect();p((null==t?void 0:t.top)-150||0),m((null==t?void 0:t.left)+t.width+30||0),c(!a)},children:[(0,n.jsxs)(h.Z,{fontSize:"12px",fontWeight:500,children:["More options ",b?(0,n.jsxs)("span",{children:["( ",3," credits)"]}):null]}),(0,n.jsx)(O.Z,{fontSize:"small"})]}),(0,n.jsx)(G.ZP,{anchorReference:"anchorPosition",anchorPosition:{top:d,left:x},open:a,onClose:()=>{c(!1)},sx:{"& .MuiPopover-paper":{width:"320px",borderRadius:"10px",background:"#000",boxShadow:"0px 4px 15px 0px rgba(0, 0, 0, 0.80)",border:"1px solid #313131",padding:"24px 16px 16px 16px"}},children:(0,n.jsx)(ep,{onClose:()=>c(!1),onSelect:e=>i(e,!0),dealWithDisplayPrompt:o})})]})};var em=r(48867),eg=r(42422);let eb=e=>{let{prompt:t,className:r,options:i,loading:o,type:a,MoreGeneratingComponent:c,isGenerated:u,recentUserInputDescribe:d,recentUserInputPrompt:p,setPrompt:x,dealWithDisplayPrompt:m,autoEnhance:g,onAutoEnhanceChange:b}=e,f=(0,l.useMemo)(()=>c||ex,[c]);return(0,n.jsx)(P.Z,{className:r,component:"div",sx:{borderRadius:"5px",padding:"7px 0px",border:"1px solid #444",cursor:"pointer",display:"edit"===a?"none":"flex","& .MuiChip-label":{pr:u?"2px":void 0},backgroundColor:"transparent"},size:"small",label:o?(0,n.jsxs)(s.Z,{direction:"row",spacing:1,alignItems:"center",children:[(0,n.jsx)(I.Z,{size:16}),(0,n.jsx)(h.Z,{variant:"editor-label1",children:"Enhancing"})]}):u?(0,n.jsx)(f,{recentUserInputDescribe:d,recentUserInputPrompt:p,setPrompt:x,dealWithDisplayPrompt:m}):(null==t?void 0:t.length)>0?(0,n.jsx)(L,{options:i,autoEnhance:g,onAutoEnhanceChange:b}):(0,n.jsx)(ef,{setPrompt:x})})};function ef(e){let{setPrompt:t}=e,r=(0,em.k)(),{showModal:l}=(0,m.dd)();return(0,n.jsxs)(s.Z,{direction:"row",spacing:1,alignItems:"center",onClick:()=>{if(!r){(0,eg.uT)();return}l(g.Z,{setPrompt:t,showCreateButton:!1})},children:[(0,n.jsx)(M.PhImageDuotone,{}),(0,n.jsx)(h.Z,{variant:"editor-label1",children:"Image to Prompt"})]})}let ev=e=>{let{undo:t,haveBefore:r}=e;return r?(0,n.jsx)(P.Z,{component:"div",size:"small",sx:{borderRadius:"8px",padding:"none",backgroundColor:"white",color:ed.tE,cursor:"pointer"},label:(0,n.jsx)(s.Z,{direction:"row",alignItems:"center",spacing:.2,onClick:t,children:(0,n.jsx)(h.Z,{variant:"editor-label1",children:"Undo"})})}):null},ej=(0,l.createContext)(null);var ey=r(2345);let eZ=e=>{let t=(0,l.useContext)(ej);if(!t)throw Error("usePromptStore must be used within a PromptStoreProvider");return(0,ey.o)(t,e)},eC=e=>{let{isMobile:t,setPrompt:r,dealWithDisplayPrompt:i}=e,[o,a]=(0,l.useState)(!1),c=eZ(e=>e.recentUserInputPrompt.value),{start:u,isNew:d}=eu({prompt:c,num_return_sequences:3,model:Z,...eZ(e=>e.recentUserInputPrompt.describe)}),p=()=>{a(!1)},x=()=>{u(),a(!o)};return t?{openMoreOnMobile:o,operation:()=>(0,n.jsxs)(s.Z,{direction:"row",alignItems:"center",justifyContent:"center",spacing:.5,height:"100%",width:"100%",padding:"0",onClick:x,children:[(0,n.jsxs)(h.Z,{variant:"editor-label1",children:["See more options ",d?(0,n.jsx)("span",{children:"( 3 credits)"}):null]}),(0,n.jsx)(O.Z,{fontSize:"small"})]}),MorePromptContent:()=>(0,n.jsx)(ep,{onClose:p,isMobile:!0,sx:{display:o?"block":"none",marginTop:"10px"},onSelect:r,dealWithDisplayPrompt:i})}:{}};var ew=r(72301),ek=r(34077),eP=r(52973);let eI=(e,t)=>{let r=!1,n=!1,l=(0,ek.M)()((0,eP.mW)((l,i)=>({currentPromptIndex:0,promptHistory:e?[e]:[],haveBefore:!1,recentUserInputPrompt:new et.NL({prompt:"",is_generated:!1}),notifyExternalChange:e=>{!r&&n&&t&&t(e)},undo:()=>{l(e=>{let{currentPromptIndex:t,promptHistory:r}=e;if(t>0){let e=t-1,n=r[e];return i().notifyExternalChange(n),{currentPromptIndex:e,haveBefore:e>0}}return e},!1,"undo")},redo:()=>{l(e=>{let{currentPromptIndex:t,promptHistory:r}=e,n=t+1;if(n<r.length){let e=r[n];return i().notifyExternalChange(e),{currentPromptIndex:n,haveBefore:!0}}return{haveBefore:!1}},!1,"redo")},setPrompt:e=>{l(t=>{let r=t.promptHistory.slice(0,t.currentPromptIndex+1);r.push(e),i().notifyExternalChange(e);let n=r.length-1;return{promptHistory:r,currentPromptIndex:n,haveBefore:n>0}},!1,"setPrompt")},syncExternalValue:e=>{if(e)try{if(n)return;r=!0;let t=i(),o=t.promptHistory[t.currentPromptIndex];ee.Z(e,o)||l(t=>{let r=[...t.promptHistory.slice(0,t.currentPromptIndex+1),e],n=r.length-1;return{promptHistory:r,currentPromptIndex:n,haveBefore:n>0}},!1,"syncExternalValue"),e.isGenerated||ee.Z(e,t.recentUserInputPrompt)||l({recentUserInputPrompt:e},!1,"updateRecentUserInputPrompt")}finally{r=!1}}}),{trace:!0}));l.subscribe((t,r)=>{!(t.promptHistory.length>0)&&e&&l.setState({promptHistory:[e]},!1,"initPromptHistory")});let i={setPrompt:e=>{try{n=!0,l.getState().setPrompt(e)}finally{n=!1}},undo:()=>{try{n=!0,l.getState().undo()}finally{n=!1}},redo:()=>{try{n=!0,l.getState().redo()}finally{n=!1}},syncExternalValue:ew.Z(e=>{l.getState().syncExternalValue(e)},50,{leading:!1,trailing:!0})};return{...l,...i}},eS=e=>{let{value:t,onChange:r,children:i}=e,o=(0,l.useMemo)(()=>eI(t,r),[r]);return(0,l.useEffect)(()=>{o.syncExternalValue(t)},[o,t]),(0,n.jsx)(ej.Provider,{value:o,children:i})},eE=(0,l.memo)(function(e){var t;let{placeholder:r="e.g. A cat is sitting on a table. We support all languages.",value:d,InputProps:p,showActionButtons:h=!0,enhancePromptProps:x,dealWithDisplayPrompt:b,autoEnhance:f,onAutoEnhanceChange:v,openDialog:j}=e,y=(0,l.useContext)(ej),C=y.setPrompt,w=y.undo,P=eZ(e=>e.haveBefore),I=eZ(e=>e.recentUserInputPrompt.describe),S=eZ(e=>e.recentUserInputPrompt.value),{showModal:E}=(0,m.dd)(),z=(0,em.k)(),{isMobile:R}=(0,N.j)(),[A,D]=ei(),F=(0,l.useRef)(null),U=(0,l.useRef)(null),W=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];C(new et.NL({prompt:e,is_generated:t,describe:x}))},{operation:B,MorePromptContent:_,openMoreOnMobile:H}=eC({isMobile:R,setPrompt:e=>{W(e,!0)},dealWithDisplayPrompt:b}),T=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(await A({...x,prompt:d.value,num_return_sequences:1,model:Z,...e}))[0].prompt;C(new et.NL({prompt:t,is_generated:!0,describe:e}))},L=[{value:"quick",label:"Quick Enhance",disabled:!1,credit:1,icon:(0,n.jsx)(o.Z,{}),onclick:()=>{if(!z){(0,eg.uT)();return}T()}},{value:"customize",label:"Customize Prompt",disabled:!1,credit:1,icon:(0,n.jsx)(i.Z,{}),onclick:()=>{if(!z){(0,eg.uT)();return}U.current.open()}},{value:"img2prompt",label:"Image to Prompt",disabled:!1,credit:0,amplitude:"img2prompt",icon:(0,n.jsx)(M.PhImageDuotone,{height:24,width:24}),onclick:()=>{if(!z){(0,eg.uT)();return}E(g.Z,{setPrompt:W,showCreateButton:!1})}}],O=j?4:15,G=(0,l.useCallback)(()=>{var e,t,r;return!p||j?p:(null==x?void 0:x.mode)==="multipleCharacter"||(null==x?void 0:x.mode)==="character"?{...p,inputProps:{...p.inputProps,sx:{...p.inputProps.sx,lineHeight:"23px",minHeight:`${23*O}px`,maxHeight:"460px",overflowY:"auto"}}}:(null===(e=p.inputProps)||void 0===e?void 0:e.sx)?{...p,inputProps:{...p.inputProps,sx:{...p.inputProps.sx,lineHeight:"23px",minHeight:"unset",maxHeight:"unset"}}}:(null===(r=p.slotProps)||void 0===r?void 0:null===(t=r.input)||void 0===t?void 0:t.sx)?{...p,slotProps:{...p.slotProps,input:{...p.slotProps.input,sx:{...p.slotProps.input.sx,lineHeight:"23px",minHeight:"unset",maxHeight:"unset"}}}}:p},[p,null==x?void 0:x.mode,O,j]);return(0,n.jsxs)(s.Z,{sx:{position:"relative"},spacing:2,children:[(0,n.jsxs)(s.Z,{sx:{position:"relative",width:"100%"},children:[(0,n.jsx)(c.Z,{ref:F,multiline:!0,placeholder:r,fullWidth:!0,value:null==d?void 0:d.value,onChange:e=>W(e.target.value),InputProps:G(),minRows:O,maxRows:20,sx:{width:"100%","& .MuiInputBase-input":{mb:3,width:"100%",lineHeight:"23px",pr:j?R?3:4.75:2,boxSizing:"border-box"},"& .MuiInputBase-root":{position:"relative",width:"100%"}}}),h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.Z,{direction:"row",sx:{zIndex:10,...H?{mt:2}:{position:"absolute",bottom:"5px",right:"5px"}},spacing:1,children:[(0,n.jsx)(ev,{undo:w,haveBefore:P}),(0,n.jsx)(eb,{prompt:null==d?void 0:d.value,className:"enhance-prompt-select",MoreGeneratingComponent:B,options:L,loading:D,isGenerated:d.isGenerated,recentUserInputDescribe:I,recentUserInputPrompt:S,setPrompt:W,dealWithDisplayPrompt:b,autoEnhance:f,onAutoEnhanceChange:v})]}),_?(0,n.jsx)(_,{}):null]}):null]}),(0,n.jsx)(k,{ref:U,onOk:T}),j&&(null==p?void 0:null===(t=p.sx)||void 0===t?void 0:t.display)!=="none"?(0,n.jsx)(u.Z,{onClick:j,sx:{position:"absolute",padding:"4px",top:-4,right:R?4:24,zIndex:11,color:"text.secondary","&:hover":{color:"text.primary",backgroundColor:"action.hover"}},children:(0,n.jsx)(a.Z,{sx:{fontSize:14}})}):null]})}),ez=(0,l.memo)(function(e){let{open:t,onClose:r,...l}=e;return(0,n.jsxs)(d.Z,{open:t,onClose:r,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{bgcolor:"background.paper",borderRadius:2,maxWidth:"919px",width:"100%",minHeight:"500px"}},children:[(0,n.jsxs)(p.Z,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",p:2,borderBottom:"1px solid",borderColor:"divider"},children:[(0,n.jsx)(h.Z,{variant:"h6",fontWeight:600,children:"Prompt"}),(0,n.jsx)(u.Z,{onClick:r,sx:{color:"text.secondary","&:hover":{color:"text.primary",backgroundColor:"action.hover"}},children:(0,n.jsx)(M.PhX,{size:24})})]}),(0,n.jsx)(x.Z,{sx:{p:2,"&.MuiDialogContent-root":{pt:3}},children:(0,n.jsx)(eE,{...l})})]})}),eR=(0,l.memo)(function(e){let[t,r]=(0,l.useState)(!1);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eE,{...e,openDialog:()=>r(!0)}),t?(0,n.jsx)(ez,{...e,open:t,onClose:()=>r(!1)}):null]})}),eA=e=>{let{value:t,placeholder:r,onChange:l,InputProps:i,showActionButtons:o,enhancePromptProps:a,dealWithDisplayPrompt:s,autoEnhance:c,onAutoEnhanceChange:u}=e;return(0,n.jsx)(eS,{value:t,onChange:l,children:(0,n.jsx)(eR,{value:t,placeholder:r,InputProps:i,showActionButtons:o,enhancePromptProps:a,dealWithDisplayPrompt:s,autoEnhance:c,onAutoEnhanceChange:u})})}},48689:function(e,t,r){r.d(t,{t:function(){return u}});var n=r(52676),l=r(80110),i=r(82639),o=r(70811),a=r(32964),s=r(39204),c=r(89252);let u=e=>{let{value:t,options:r,onChange:u,id:d,disabled:p,disabledReason:h,sx:x,buttonSx:m}=e;return(0,n.jsx)(o.Z,{direction:"row",sx:{bgcolor:"#1E1E1E",borderRadius:c.tO,border:`1px solid ${p?"#2a2a2a":c.b5}`,overflow:"hidden",position:"relative",width:"100%",minWidth:0,opacity:p?.75:1,...x},children:r.map(e=>{let r=p||e.disabled,o=r?e.disabled?e.disabledReason:h:void 0,x=(0,n.jsxs)(a.Z,{sx:{px:1.5,py:.3,color:"white",cursor:r?"not-allowed":"pointer",position:"relative",zIndex:1,flex:1,textAlign:"center",...m},onClick:t=>{r||u(e.value)},children:[(0,n.jsx)(l.Z,{variant:"editor-label1",color:r?t===e.value?"#8ba6c6":"#676767":t===e.value?c.Xp:c.F2,fontWeight:{xs:400,md:500},fontSize:{xs:11,sm:12},sx:{whiteSpace:"nowrap"},children:e.label}),t===e.value&&(0,n.jsx)(s.E.div,{layoutId:`activeToggle-${d}`,initial:{opacity:0},animate:{opacity:1},transition:{duration:.3,type:"spring",stiffness:500,damping:30},style:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:r?"#2a3748":c.G9,zIndex:-1}})]},e.value.toString());return r&&o?(0,n.jsx)(i.Z,{title:o,arrow:!0,placement:"top",children:x},e.value.toString()):x})})}},28774:function(e,t,r){r.d(t,{f:function(){return b}});var n=r(52676),l=r(75271),i=r(56407),o=r(22988),a=r(80110),s=r(68836),c=r(81159),u=r(72509),d=r(69502),p=r(89252),h=r(79446),x=r(27806);let m=e=>{let{height:t,previewUrl:r,title:i,isUploading:s,error:m,onDrop:g,onClear:b,onHistorySelect:f,allowMultiple:v=!0,disabled:j=!1,maxSelectionCount:y=4}=e,Z=(0,h.B)(),C=(0,l.useRef)(null),w=!!r,{UploadContextMenu:k,handleMenuOpen:P}=(0,u.w)({onChange:e=>{e&&e.length>0&&!j&&(null==f||f(e))},onClickUpload:()=>{var e;return null===(e=C.current)||void 0===e?void 0:e.triggerInputClick()},maxSelectionCount:v?y:1,showCharacter:!0});return(0,n.jsxs)(o.Z,{sx:{borderRadius:3,backgroundColor:"#2C2E35",position:"relative"},children:[(0,n.jsx)(d.Z,{ref:C,buttonVariant:!0,disabled:j,sx:{width:"100%",height:t,border:"none",backgroundColor:p.hb,borderRadius:p.zO,overflow:"hidden",margin:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"relative"},dropZoneSx:{borderRadius:p.zO,width:"100%",padding:0,backgroundColor:"transparent"},file:w?{preview:r}:null,isUploading:s,onDrop:g,onChange:()=>{},onAreaClick:j?void 0:e=>Z({onAuthenticated:P,e}),multiple:v,title:i,onDelete:b,accept:{"image/png":[],"image/jpeg":[],"image/webp":[]},caption:m?(0,n.jsx)(a.Z,{variant:"caption",sx:{padding:"0 8px",display:"inline-block",position:"absolute",bottom:0,left:"50%",transform:"translateX(-50%)",pointerEvents:"none",width:"100%"},color:"error.main",children:m}):null}),k,w?(0,n.jsx)(c.Z,{title:"Delete the image",icon:x.FaTrash,iconSize:20,sx:{position:"absolute",top:8,right:8,cursor:"pointer"},onClick:()=>{b()}}):null]})};m.displayName="UploadFourImageSlot";var g=r(46973);let b=e=>{var t;let{value:r,onChange:c,maxImages:u=4,sx:d,uploadUrl:h="/media/upload_image",checker:b}=e,f=(0,l.useCallback)(e=>Array.from({length:u},(t,r)=>(null==e?void 0:e[r])??""),[u]),[v,j]=(0,l.useState)(()=>f(r)),[y,Z]=(0,l.useState)(()=>Array.from({length:u},()=>null)),[C,w]=(0,l.useState)(()=>Array.from({length:u},()=>!1)),[k,P]=(0,l.useState)(()=>Array.from({length:u},()=>null)),I=(0,l.useRef)(y),S=(0,l.useRef)(v),E=(0,l.useCallback)(e=>{(null==e?void 0:e.preview)&&URL.revokeObjectURL(e.preview)},[]),z=(0,l.useCallback)((e,t,r)=>e.length===t?e:e.length>t?e.slice(0,t):e.concat(Array.from({length:t-e.length},r)),[]),R=(0,l.useCallback)(e=>e.length===u?e:e.length>u?(e.slice(u).forEach(E),e.slice(0,u)):e.concat(Array.from({length:u-e.length},()=>null)),[u,E]);(0,l.useEffect)(()=>{let e=f(r);j(e),S.current=e},[f,r]),(0,l.useEffect)(()=>{I.current=y},[y]),(0,l.useEffect)(()=>{S.current=v},[v]),(0,l.useEffect)(()=>{Z(e=>R(e)),w(e=>z(e,u,()=>!1)),P(e=>z(e,u,()=>null)),j(e=>z(e,u,()=>""))},[R,u,z]),(0,l.useEffect)(()=>()=>{I.current.forEach(e=>E(e))},[E]);let A=(0,l.useCallback)(e=>{if(e instanceof s.AxiosError){var t;let r=null===(t=e.response)||void 0===t?void 0:t.data;if("string"==typeof r)return r;if(null==r?void 0:r.message)return r.message}return e instanceof Error&&e.message?e.message:"Failed to upload image"},[]),D=(0,l.useCallback)(async(e,t)=>{let r=t=>{w(r=>{let n=z(r,u,()=>!1);if(n[e]===t&&n===r)return r;let l=n.slice();return l[e]=t,l})};r(!0);try{let r=new FormData;r.append("file",t.file);let n=await g.ZP.post(h,r,{headers:{"Content-Type":"multipart/form-data"}});if(200!==n.status||!n.data)throw Error("Upload failed");let l=n.data;if(b&&!await b(l))throw Error("Image validation failed");if(I.current[e]!==t)return;E(t),Z(t=>{let r=R(t).slice();return r[e]=null,r}),P(t=>{let r=z(t,u,()=>null);if(null===r[e]&&r===t)return t;let n=r.slice();return n[e]=null,n}),j(t=>{let r=z(t,u,()=>"").slice();return r[e]=l.imageUrl,S.current=r,r});let i=S.current,o=f(i);o[e]=l.imageUrl,S.current=o,c(o)}catch(r){let t=A(r);P(r=>{let n=z(r,u,()=>null).slice();return n[e]=t,n})}finally{I.current[e]===t&&r(!1)}},[b,f,R,A,u,c,E,z,h]),F=(0,l.useCallback)((e,t)=>{if(!t||0===t.length)return;let r=[],n=e,l=[];t.forEach(e=>{n<u&&(l.push(e),n+=1)}),0!==l.length&&(n=e,Z(e=>{let t=R(e).slice();return l.forEach(e=>{let l=URL.createObjectURL(e),i={file:e,preview:l},o=t[n];o&&E(o),t[n]=i,r.push({index:n,pending:i}),n+=1}),t}),P(e=>{let t=z(e,u,()=>null).slice();return r.forEach(e=>{let{index:r}=e;t[r]=null}),t}),w(e=>{let t=z(e,u,()=>!1).slice();return r.forEach(e=>{let{index:r}=e;t[r]=!0}),t}),r.forEach(e=>{let{index:t,pending:r}=e;D(t,r)}))},[R,u,E,z,D]),U=(0,l.useCallback)(e=>{Z(t=>{let r=R(t).slice(),n=r[e];return n&&E(n),r[e]=null,r}),P(t=>{let r=z(t,u,()=>null).slice();return r[e]=null,r}),w(t=>{let r=z(t,u,()=>!1).slice();return r[e]=!1,r}),j(t=>{let r=z(t,u,()=>"");if(""===r[e]&&null===I.current[e])return t;let n=r.slice();return n[e]="",S.current=n,n});let t=S.current;if(t[e]){let r=f(t);r[e]="",S.current=r,c(r)}},[f,R,u,c,E,z]),W=(0,l.useCallback)(async(e,t)=>{if(!t||0===t.length)return;let r=e,n=[];if(t.forEach(e=>{r>=u||(n.push({index:r,url:e}),r+=1)}),0===n.length)return;Z(e=>{let t=R(e).slice();return n.forEach(e=>{let{index:r}=e,n=t[r];n&&E(n),t[r]=null}),t}),P(e=>{let t=z(e,u,()=>null).slice();return n.forEach(e=>{let{index:r}=e;t[r]=null}),t}),w(e=>{let t=z(e,u,()=>!1).slice();return n.forEach(e=>{let{index:r}=e;t[r]=!0}),t});let l=await Promise.allSettled(n.map(async e=>{let{index:t,url:r}=e;return new Promise(e=>{let n=new Image;n.addEventListener("load",async()=>{try{let l={imageUrl:r,width:n.width,height:n.height};if(b&&!await b(l)){e({index:t,url:r,success:!1,error:"Image validation failed"});return}e({index:t,url:r,success:!0})}catch(n){e({index:t,url:r,success:!1,error:A(n)})}}),n.addEventListener("error",()=>{e({index:t,url:r,success:!1,error:"Failed to load image"})}),n.src=r})})),i=[],o=[];if(l.forEach(e=>{if("fulfilled"===e.status){let{index:t,url:r,success:n,error:l}=e.value;n?i.push({index:t,url:r}):o.push({index:t,error:l||"Unknown error"})}else{let t=n.find((t,r)=>r===l.indexOf(e));t&&o.push({index:t.index,error:"Failed to process image"})}}),i.length>0){j(e=>{let t=z(e,u,()=>"").slice();return i.forEach(e=>{let{index:r,url:n}=e;t[r]=n}),S.current=t,t});let e=f(S.current);i.forEach(t=>{let{index:r,url:n}=t;e[r]=n}),S.current=e,c(e)}o.length>0&&P(e=>{let t=z(e,u,()=>null).slice();return o.forEach(e=>{let{index:r,error:n}=e;t[r]=n}),t}),w(e=>{let t=z(e,u,()=>!1).slice();return n.forEach(e=>{let{index:r}=e;t[r]=!1}),t})},[b,f,R,A,u,c,E,z]),B=(0,l.useMemo)(()=>y.some(Boolean)||v.some(e=>!!e),[y,v]),N=(0,l.useMemo)(()=>Array.from({length:u},(e,t)=>t),[u]);return(0,n.jsx)(i.Z,{sx:{backgroundColor:p.P,borderRadius:p.zO,p:2,gap:2,...d},children:(0,n.jsx)(o.Z,{sx:{display:"grid",gridTemplateColumns:B?"repeat(2, 1fr)":"1fr",gap:1},children:B?N.map(e=>{var t;return(0,n.jsx)(o.Z,{sx:{borderRadius:p.zO,overflow:"hidden",backgroundColor:p.hb,cursor:"pointer",position:"relative",height:75},children:(0,n.jsx)(m,{height:75,previewUrl:(null===(t=y[e])||void 0===t?void 0:t.preview)||v[e]||void 0,maxSelectionCount:u-e,title:(0,n.jsxs)(i.Z,{direction:"row",justifyContent:"center",alignItems:"center",spacing:1,children:[(0,n.jsx)(x.PhImageDuotone,{size:24}),(0,n.jsx)(x.PhPersonArmsSpread,{size:24}),(0,n.jsx)(x.PhAppleLogoDuotone,{size:24})]}),isUploading:C[e]??!1,error:k[e]??null,onDrop:t=>F(e,t),onClear:()=>U(e),onHistorySelect:t=>W(e,t)})},e)}):(0,n.jsx)(o.Z,{sx:{borderRadius:p.zO,overflow:"hidden",backgroundColor:p.hb,cursor:"pointer",position:"relative"},children:(0,n.jsx)(m,{height:160,previewUrl:(null===(t=y[0])||void 0===t?void 0:t.preview)||v[0]||void 0,maxSelectionCount:u,title:(0,n.jsxs)(i.Z,{direction:"column",alignItems:"center",justifyContent:"center",spacing:1,sx:{width:"100%"},children:[(0,n.jsxs)(i.Z,{direction:"row",justifyContent:"center",alignItems:"center",spacing:1,children:[(0,n.jsx)(x.PhImageDuotone,{size:24}),(0,n.jsx)(x.PhPersonArmsSpread,{size:24}),(0,n.jsx)(x.PhAppleLogoDuotone,{size:24})]}),(0,n.jsxs)(a.Z,{color:p.d6,fontSize:12,children:["Drag & drop up to ",u," images"]}),(0,n.jsxs)(a.Z,{color:p.b5,fontSize:12,textAlign:"center",children:["Use up to ",u," Backgrounds, characters or items, and combine them freely"]})]}),isUploading:C[0]??!1,error:k[0]??null,onDrop:e=>F(0,e),onClear:()=>U(0),onHistorySelect:e=>W(0,e)})})})})}},69502:function(e,t,r){var n=r(52676),l=r(75271),i=r(20041),o=r(19219),a=r(16301),s=r(22988),c=r(80110),u=r(29984),d=r(57672),p=r(25110),h=r(84625),x=r(68926),m=r(44567);let g="upload-image-in-video-button",b=(0,l.forwardRef)((e,t)=>{let{error:r,file:b,isUploading:f,caption:v,sx:j,dropZoneSx:y,bordered:Z,title:C="Click or drag a photo to upload",zoomable:w,deletable:k,onDelete:P,onDrop:I,onChange:S,multiple:E,disabled:z=!1,accept:R,showIcon:A=!0,buttonVariant:D,onAreaClick:F,...U}=e,W=(0,d.Z)(),{getRootProps:B,getInputProps:N,isDragActive:M,isDragReject:_,fileRejections:H,inputRef:T}=(0,h.uI)({multiple:E,accept:R??{"image/png":[],"image/jpeg":[],"image/webp":[],"image/gif":[],"image/svg+xml":[],"image/apng":[],"image/avif":[],"image/bmp":[]},onDrop:e=>{e.length>0?null==S||S(E?e:e[0]):null==S||S(null),null==I||I(e)},disabled:z,noClick:!!F,...U}),L=B(),O=()=>{T.current&&T.current.click()};(0,l.useImperativeHandle)(t,()=>({triggerInputClick:O}));let[G,q]=(0,l.useState)(!1),V=e=>{q(e)},$=e=>{if(!F)return;let t=e.target,r=!1;for(;t&&t!==e.currentTarget;){if(t.classList.contains(g)){r=!0;break}t=t.parentElement}r||F(e)},Q=b&&(b.preview||(b.file?URL.createObjectURL(b.file):"")),K={display:"flex",position:"absolute",alignItems:"center",flexDirection:"column",justifyContent:"center",color:W.palette.text.secondary,backgroundColor:D?null:W.palette.background.neutral,transition:W.transitions.create("opacity",{duration:W.transitions.duration.shorter}),"&:hover":{opacity:D&&!b?1:.72},...b&&{opacity:0,color:"common.white",bgcolor:"grey.900","&:hover":{opacity:.72}}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.Z,{sx:(0,m.j)({width:144,height:144,margin:"auto",borderRadius:"50%",padding:W.spacing(1),position:"relative",border:!1===Z?"none":`1px dashed ${W.palette.grey[50032]}`},j),children:[f?(0,n.jsx)(s.Z,{sx:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%,-50%)",zIndex:9999,color:"white"},children:(0,n.jsx)(u.Z,{})}):null,(0,n.jsxs)(s.Z,{...L,onClick:F?$:L.onClick,onContextMenu:F?$:void 0,sx:{zIndex:0,width:"100%",height:"100%",outline:"none",display:"flex",overflow:"hidden",borderRadius:"50%",position:"relative",alignItems:"center",justifyContent:"center",[`& > *:not(.${g})`]:{width:"100%",height:"100%"},"&:hover":{cursor:"pointer","& .placeholder":{zIndex:9}},...M&&{opacity:.72},...(_||r)&&{color:"error.main",borderColor:"error.light",bgcolor:"error.lighter"},...y},children:[(0,n.jsx)("input",{...N()}),b?w?(0,n.jsx)(s.Z,{onClick:e=>e.stopPropagation(),sx:{"&>div, &>div>div, & img":{height:"100%",width:"100%"}},children:(0,n.jsx)(x.f,{zoomMargin:20,isZoomed:G,onZoomChange:V,children:(0,n.jsx)(s.Z,{component:"img",alt:"avatar",src:Q,sx:{zIndex:8,objectFit:"contain"}})})}):(0,n.jsx)(s.Z,{component:"img",alt:"avatar",src:Q,sx:{zIndex:8,objectFit:"contain"}}):null,(0,n.jsx)(s.Z,{className:"placeholder",sx:K,children:C}),b&&w?(0,n.jsx)(s.Z,{className:g,sx:{position:"absolute",top:4,right:4,zIndex:1e3,background:"rgba(0,0,0,0.5)",width:30,height:30,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:1},onClick:e=>{e.stopPropagation(),V(!0)},children:(0,n.jsx)(o.Z,{})}):null,b&&k?(0,n.jsx)(s.Z,{className:g,sx:{position:"absolute",top:4,right:40,zIndex:1e3,background:"rgba(0,0,0,0.5)",width:30,height:30,display:"flex",justifyContent:"center",alignItems:"center",borderRadius:1},onClick:e=>{e.stopPropagation(),null==P||P(),null==S||S(null)},children:(0,n.jsx)(i.Z,{})}):null]})]}),v,H.length>0&&(0,n.jsx)(a.Z,{variant:"outlined",sx:{py:1,px:2,my:2,borderColor:"error.light",bgcolor:e=>(0,p.Fq)(e.palette.error.main,.08)},children:H.map(e=>{let{file:t,errors:r}=e,{name:l}=t;return(0,n.jsxs)(s.Z,{sx:{my:1},children:[(0,n.jsx)(c.Z,{variant:"subtitle2",noWrap:!0,children:l}),r.map(e=>(0,n.jsxs)(c.Z,{variant:"caption",component:"p",children:["- ",e.message]},e.code))]},l)})})]})});b.displayName="UploadAvatar",t.Z=b},87345:function(e,t,r){r.d(t,{a:function(){return o},y:function(){return a}});var n=r(75271),l=r(15830);let i=(0,n.createContext)(null),o=i.Provider,a=()=>(0,n.useContext)(i)||l.V.CREATE},30931:function(e,t,r){r.d(t,{N:function(){return n}});function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"object"==typeof e&&"getValue"in e?e.getValue():"string"==typeof e&&"none"===e.toLocaleLowerCase()?"":e}},45468:function(e,t,r){r.d(t,{NA:function(){return l.N},NL:function(){return i.N},Sj:function(){return n.S}});var n=r(15749),l=r(30931),i=r(16450);r(24601),r(47963)},6045:function(e,t,r){r.d(t,{S:function(){return o}});var n=r(75271),l=r(86657),i=r(7999);function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"back-to-top",r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:300;(0,n.useEffect)(()=>{if(e&&!e.current)return;let n=document.getElementById(t);return n||((0,l.addBackToTop)({id:t,diameter:48,scrollDuration:500,backgroundColor:i.mP,zIndex:1e3,showWhenScrollTopIs:o,scrollContainer:e?e.current:document.body}),n=document.getElementById(t)),n&&(n.style.display=r?"block":"none"),()=>{null==n||n.remove()}},[o,r,t,e])}}}]);