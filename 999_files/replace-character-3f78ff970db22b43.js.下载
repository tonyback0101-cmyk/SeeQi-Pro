(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8943],{102:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/video/replace-character",function(){return t(52357)}])},45308:function(e,r,t){"use strict";t.d(r,{o:function(){return x}});var o=t(52676),a=t(75271),i=t(77379),n=t(56407),l=t(22988),s=t(80110),c=t(60588),d=t(76651),p=t(39204),u=t(23638),h=t(27806),m=t(97779);function x(e){let{value:r,onChange:t,supportMediaTypes:x,modelOptions:g}=e,{isMobile:v}=(0,m.j)(),[f,b]=(0,a.useState)(null),y=(0,a.useRef)(null),j=(0,a.useMemo)(()=>Object.entries(g).filter(e=>{let[r,t]=e;return!t.hidden}).map(e=>{let[r,t]=e;return{value:r,...t}}).filter(e=>x.includes(e.mediaType)),[g,x]),C=j.find(e=>e.value===r)||{value:"",displayName:"Select Model",iconUrl:"",iconColor:""},w=!!f,k=()=>{b(null)},Z=e=>{t(e),k()};return(0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&k()};return w&&document.addEventListener("keydown",e),()=>{document.removeEventListener("keydown",e)}},[w]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.Z,{ref:y,variant:"outlined",fullWidth:!0,onClick:j.length>1?e=>{b(e.currentTarget)}:void 0,endIcon:j.length>1?v?(0,o.jsx)(p.E.div,{animate:{rotate:w?180:0},transition:{duration:.2},children:(0,o.jsx)(h.PhCaretDown,{size:24})}):(0,o.jsx)(p.E.div,{animate:{rotate:w?180:0},transition:{duration:.2},children:(0,o.jsx)(h.PhCaretRight,{size:24})}):null,sx:{justifyContent:"space-between",backgroundColor:"transparent",borderColor:e=>e.palette.Colors.Gray["300"],color:e=>e.palette.text.primary,textTransform:"none",px:1.5,py:1.5,minHeight:48,"&:hover":{borderColor:e=>e.palette.Colors.Gray["400"],backgroundColor:e=>e.palette.Colors.Gray["50"]},"&.Mui-focused":{borderColor:e=>e.palette.Colors.Blue["500"]},mb:2},children:(0,o.jsxs)(n.Z,{direction:"row",alignItems:"center",spacing:1,children:[C.iconUrl?(0,o.jsx)(l.Z,{component:"img",src:C.iconUrl,alt:C.displayName,sx:{width:18,height:18,borderRadius:.5,objectFit:"contain"}}):(0,o.jsx)(h.PhCircle,{size:14,style:{color:C.iconColor||"#666"}}),(0,o.jsx)(s.Z,{variant:"body2",fontWeight:500,sx:{fontSize:"14px"},children:C.displayName})]})}),(0,o.jsx)(c.ZP,{open:w,anchorEl:f,onClose:k,anchorOrigin:{vertical:v?"bottom":"top",horizontal:v?"left":"right"},transformOrigin:{vertical:"top",horizontal:"left"},slotProps:{paper:{sx:{...v?{mt:.5}:{ml:.5},minWidth:280,maxWidth:350,backgroundColor:"#101010",color:"white",borderRadius:2,boxShadow:"0px 8px 32px rgba(0, 0, 0, 0.3)",border:"1px solid",borderColor:"#202020"}}},disableScrollLock:!0,children:(0,o.jsx)(n.Z,{spacing:0,sx:{p:1},children:j.map(e=>(0,o.jsx)(p.E.div,{whileTap:{scale:.98},children:(0,o.jsx)(l.Z,{onClick:()=>Z(e.value),sx:{my:.5,p:2,borderRadius:1,cursor:"pointer",transition:"background-color 0.2s",position:"relative",backgroundColor:e.value===r?"rgba(59, 130, 246, 0.15)":"transparent",border:e.value===r?"1px solid rgba(59, 130, 246, 0.3)":"1px solid transparent","&:hover":{backgroundColor:e.value===r?"rgba(59, 130, 246, 0.2)":"rgba(255, 255, 255, 0.05)"}},children:(0,o.jsxs)(n.Z,{spacing:1,children:[(0,o.jsxs)(n.Z,{direction:"row",alignItems:"center",spacing:1,children:[e.iconUrl?(0,o.jsx)(l.Z,{component:"img",src:e.iconUrl,alt:e.displayName,sx:{width:20,height:20,borderRadius:1,objectFit:"contain"}}):(0,o.jsx)(h.PhCircle,{size:14,style:{color:e.iconColor||"#666"}}),(0,o.jsx)(s.Z,{variant:"body1",fontWeight:600,color:"white",children:e.displayName}),e.tag?(0,o.jsx)(d.Z,{label:e.tag,size:"small",sx:{backgroundColor:e.tagColor||"#4CAF50",color:"white",fontSize:"10px",height:20}}):null,(0,o.jsx)(l.Z,{sx:{ml:"auto"},children:(0,o.jsx)(u.M,{children:e.value===r&&(0,o.jsx)(p.E.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},children:(0,o.jsx)(h.PhCheck,{size:16,style:{color:"#4CAF50"}})})})})]}),(0,o.jsx)(s.Z,{variant:"caption",sx:{color:"rgba(255, 255, 255, 0.7)",lineHeight:1.3,fontSize:"12px"},children:e.description}),(0,o.jsx)(l.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:(0,o.jsx)(s.Z,{variant:"caption",sx:{color:"rgba(255, 255, 255, 0.6)",fontSize:"11px",px:1,py:.25,backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:.5},children:(0,o.jsx)("span",{children:"image"===e.mediaType?"Image":"Video"})})})]})})},e.value))})})]})}},48321:function(e,r,t){"use strict";t.d(r,{P:function(){return a},g:function(){return i}});var o=t(84291);let a=o.Ry({characterUrl:o.Z_().url("Must be a valid image URL"),characterType:o.Km(["image"]),model:o.Km(["openart-replace-character"],{errorMap:()=>({message:"Invalid model selected"})}),resolution:o.Rx().min(480).max(1080),prompt:o.Z_().default("Imitate the actions in the video"),maskImageUrl:o.Z_().url("Must be a valid image URL").nullable().optional(),replaceType:o.Km(["body","face","mask"]),sourceVideoUrl:o.Z_().url("Must be a valid video URL"),sourceVideoType:o.Km(["video"])}),i={"openart-replace-character":{featureKeys:["app.replace-character.openart-replace-character"],mediaType:"image",name:"openart-replace-character",displayName:"OpenArt Replace",minVideoDuration:3,maxVideoDuration:30,supportDescription:!1,description:"seamlessly swaps faces or features in videos for realistic human transformations.",iconColor:"#E91E63",iconUrl:"https://cdn.openart.ai/music_video/openart_model_log.png"}}},52357:function(e,r,t){"use strict";t.r(r),t.d(r,{__N_SSP:function(){return ep},default:function(){return eu}});var o=t(52676),a=t(87345),i=t(15830),n=t(56407),l=t(80110),s=t(22988),c=(0,t(99664).Z)((0,o.jsx)("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.49 2 2 6.49 2 12s4.49 10 10 10 10-4.49 10-10S17.51 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"ControlPointOutlined"),d=t(43480),p=t(24475),u=t(75271),h=t(29984),m=t(46890),x=t(76651),g=t(6721),v=t(45138),f=t(60588),b=t(89228),y=t(20198),j=t(60464),C=t(59147),w=t(92832),k=t(23638),Z=t(39204),S=t(49218),R=t(76602),P=t(49049),E=t(27806);let z={image:{id:"image",label:"Select Image",icon:E.PhImage,sx:{background:"#846C10"}},character:{id:"character",label:"Character",icon:E.PhPersonArmsSpread,sx:{background:"#0063C5"}}},I=[{id:"upload",label:"Upload",icon:E.PhUploadSimple},{id:"history",label:"History",icon:E.PhClockCounterClockwise}];async function _(e){try{let r=(await fetch(e,{method:"HEAD"})).headers.get("content-length");return r?Number.parseInt(r):0}catch(e){return console.error("Failed to get image size from URL:",e),0}}async function D(e){return new Promise((r,t)=>{let o=new Image,a=null;e instanceof File?(a=URL.createObjectURL(e),o.src=a):o.src=e,o.crossOrigin="anonymous",o.addEventListener("load",()=>{a&&URL.revokeObjectURL(a),r({width:o.width,height:o.height})}),o.addEventListener("error",()=>{a&&URL.revokeObjectURL(a),t(Error(`Failed to load image from ${e instanceof File?"file":"URL"}`))})})}let T=(e,r)=>async t=>{try{if(!e)return!0;let o=0;if(o="string"==typeof t?await _(t):t.size,e.maxImageSize&&o>1048576*e.maxImageSize){let t=`Image file size must be ${e.maxImageSize}MB or less`;return null==r||r(t),!1}if(e.imageAspectRatios&&e.imageAspectRatios.length>=2)try{let o=await D(t),a=o.width/o.height,[i,n]=e.imageAspectRatios;if(a<i||a>n){let e=`Image aspect ratio must be between ${i} and ${n}`;return null==r||r(e),!1}}catch(e){console.error("Failed to get image dimensions:",e)}return!0}catch(e){return console.error("Failed to validate image file:",e),!0}};function L(e){var r;let{visual:t,modelConfig:a,visualOptions:i=[{...z.image,subOptions:I},z.character],isProcessingVisual:c=!1,cdnFolder:d="images/video",validateImage:_,onSelectSource:D,onRemove:L,onDescriptionChange:F,imageIcon:U,contentText:M,sx:O}=e,[W,G]=(0,u.useState)(!1),[V,A]=(0,u.useState)(!1),[N,H]=(0,u.useState)(!1),[K,$]=(0,u.useState)(null),[B,X]=(0,u.useState)(null),[Q,Y]=(0,u.useState)(""),[q,J]=(0,u.useState)((null==t?void 0:t.description)||""),[ee,er]=(0,u.useState)(!1),[et,eo]=(0,u.useState)(null),ea=(0,u.useRef)(null),ei=(0,u.useRef)(null),en=_||T(a,Y),{uploadFile:el,isUploading:es,progress:ec,reset:ed}=(0,P.k)({cdnFolder:`${d}/images`,onSuccess:async e=>{er(!0),eo(e.url),D((null==B?void 0:B.id)||"image","upload",e.url,q),(0,p.setTimeout)(()=>{ee&&(er(!1),eo(null))},5e3)},onError:e=>{Y(e.message),er(!1)}}),ep=(0,w.Z)(B),eu=(0,u.useCallback)(async e=>{if(ep.current){Y(""),ed();try{if("image"===ep.current.id||e.type.startsWith("image/"))try{if(!await en(e))return}catch(e){Y("Failed to validate image file");return}await el(e)}catch(e){console.error("Validation failed:",e),Y("Failed to validate media")}}},[ep,ed,el,en]),{handleShowModal:eh}=(0,S.p)({type:"image",maxSelectionCount:1,onClose:async e=>{if(e&&e.length>0){let r=e[0];try{if(!await en(r))return}catch(e){Y("Failed to validate image");return}D("image","history",r,q)}}}),{showModal:em}=(0,R.x)({onCharacterSelect:async e=>{var r;let t=(null===(r=e.sample_images)||void 0===r?void 0:r.at(-1))||e.image_url||e.thumbnail;if(t)try{if(!await en(t))return;D("image","character",t,q)}catch(e){Y("Failed to validate character image")}}}),ex=(e,r)=>{r.stopPropagation(),r.preventDefault(),A(!0),e.subOptions?($(r.currentTarget),X(e)):("character"===e.id?em():D(e.id,e.id,void 0,q),A(!1))},eg=(e,r)=>{if(r.stopPropagation(),r.preventDefault(),"history"===e.id)eh(),ev();else if("upload"===e.id){var t;null===(t=ei.current)||void 0===t||t.click(),ev()}else B&&(D(B.id,e.id,void 0,q),ev())},ev=()=>{$(null),A(!1)};(0,u.useEffect)(()=>{J((null==t?void 0:t.description)||"")},[null==t?void 0:t.description]),(0,u.useEffect)(()=>{ee&&et&&(null==t?void 0:t.url)===et&&(er(!1),eo(null))},[t,ee,et]);let ef=(0,u.useCallback)(async e=>{var r;let t=null===(r=e.target.files)||void 0===r?void 0:r[0];t&&await eu(t),ei.current&&(ei.current.value="")},[eu]);(0,u.useEffect)(()=>{let e=e=>{ea.current&&!ea.current.contains(e.target)&&A(!1)};return V&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[V]);let eb=async e=>{e.preventDefault(),e.stopPropagation(),H(!1);let r=Array.from(e.dataTransfer.files)[0];if(r&&r.type.startsWith("image/")){try{if(!await en(r))return}catch(e){Y("Failed to validate image file");return}X({id:"image",label:"",icon:null}),(0,p.setTimeout)(()=>{eu(r)},0)}};return es||ee||c||ec>0&&ec<100?(0,o.jsxs)(s.Z,{sx:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:1,p:2,borderRadius:2,border:"2px dashed",borderColor:e=>e.palette.Colors.Gray["300"],height:158,backgroundColor:e=>e.palette.Colors.Gray["100"],...O},children:[(0,o.jsxs)(s.Z,{sx:{display:"flex",alignItems:"center",gap:1,justifyContent:"center"},children:[(0,o.jsx)(h.Z,{size:16,sx:{mr:1}}),(0,o.jsx)(l.Z,{variant:"body2",color:"text.secondary",sx:{textAlign:"center"},children:ee||c?"Processing...":`Uploading... ${ec}%`})]}),es?(0,o.jsx)(s.Z,{sx:{width:"100%",mt:2},children:(0,o.jsx)(m.Z,{variant:"determinate",value:ec,sx:{height:4,borderRadius:2,backgroundColor:"rgba(0, 0, 0, 0.1)","& .MuiLinearProgress-bar":{backgroundColor:e=>e.palette.primary.main}}})}):null]}):t?(0,o.jsxs)(n.Z,{spacing:1,children:[(0,o.jsxs)(s.Z,{ref:ea,onMouseEnter:()=>G(!0),onMouseLeave:()=>G(!1),sx:{position:"relative",borderRadius:1,overflow:"hidden",backgroundColor:"#000",aspectRatio:"16/9",cursor:"pointer",height:158,border:"1px solid",borderColor:e=>e.palette.Colors.Gray["300"]},children:[("image"===t.type||"character"===t.type)&&(0,o.jsx)(s.Z,{component:"img",src:t.url,alt:t.name,sx:{width:"100%",height:"100%",objectFit:"contain"}}),(0,o.jsx)(x.Z,{label:"character"===t.source?"character":t.type,size:"small",sx:{position:"absolute",top:8,left:8,backgroundColor:"rgba(0, 0, 0, 0.6)",color:"white"}}),(0,o.jsx)(k.M,{children:W?(0,o.jsx)(Z.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},style:{position:"absolute",top:8,right:8},children:(0,o.jsx)(g.Z,{size:"small",onClick:e=>{e.stopPropagation(),null==L||L()},sx:{color:"white",backgroundColor:"rgba(255, 255, 255, 0.1)",borderRadius:"5px","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.2)"}},children:(0,o.jsx)(E.PhTrash,{size:16,color:"var(--Gray-900, #FFF)"})})}):null})]}),("image"===t.type||"character"===t.type)&&(null==a?void 0:a.supportDescription)!==!1&&(0,o.jsxs)(s.Z,{sx:{position:"relative"},children:[(0,o.jsx)(v.Z,{multiline:!0,minRows:4,maxRows:6,value:q,onChange:e=>{let r=e.target.value;J(r),null==F||F(r)},placeholder:"[Optional] Please provide a detailed description of the actions unfolding in the scene.",variant:"outlined",inputProps:{maxLength:800},sx:{width:"100%","& .MuiOutlinedInput-root":{paddingBottom:"24px",backgroundColor:"var(--Gray-100)",borderRadius:1,fontSize:"12px",lineHeight:"20px","& fieldset":{borderColor:"var(--Gray-300)"},"&:hover fieldset":{borderColor:"var(--Gray-400)"},"&.Mui-focused fieldset":{borderColor:"var(--Blue-500)",borderWidth:"1px"}},"& .MuiInputBase-input":{color:"var(--Gray-900)",fontSize:"12px",lineHeight:"20px","&::placeholder":{color:"var(--Gray-500)",opacity:1}}}}),(0,o.jsx)(s.Z,{sx:{position:"absolute",bottom:8,right:8,display:"flex",justifyContent:"flex-end",mt:.5},children:(0,o.jsxs)(l.Z,{variant:"caption",sx:{fontSize:"12px",color:q.length>720?"var(--Error)":q.length>600?"var(--Warning)":"var(--Gray-500)",fontWeight:q.length>720?500:400},children:[q.length,"/800"]})})]})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.Z,{ref:ea,onMouseEnter:()=>G(!0),onMouseLeave:()=>{G(!1)},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),H(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),e.currentTarget===e.target&&H(!1)},onDrop:eb,sx:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:1,p:2,borderRadius:1,border:"1px dashed",borderColor:e=>e.palette.Colors.Gray["400"],cursor:"pointer",transition:"all 0.2s",height:158,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover",backgroundBlendMode:"lighten",mixBlendMode:"difference","&:hover":{borderColor:e=>e.palette.Colors.Gray["400"]}},children:(0,o.jsx)(k.M,{mode:"wait",children:N?(0,o.jsxs)(Z.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},style:{display:"flex",flexDirection:"column",alignItems:"center",gap:8,padding:"16px 24px",borderRadius:8},children:[(0,o.jsx)(E.PhUploadSimple,{size:40}),(0,o.jsx)(l.Z,{variant:"body2",fontWeight:500,children:"Drop image here"})]},"dragover"):W||V||Q?(0,o.jsxs)(Z.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center",gap:12},children:[(0,o.jsx)(n.Z,{direction:"row",spacing:1,sx:{p:2,borderRadius:2},children:i.map(e=>(0,o.jsxs)(n.Z,{flexDirection:"column",alignItems:"center",sx:{p:1,px:.5,borderRadius:"8px",border:"1px solid rgba(255, 255, 255, 0.16)",backdropilter:"blur(6.5px)",color:"#fff",transition:"all 0.2s","&:hover":{transform:"scale(1.05)"},...e.sx},onClick:r=>ex(e,r),children:[(0,o.jsx)(s.Z,{children:(0,o.jsx)(e.icon,{size:24})}),(0,o.jsx)(l.Z,{variant:"body2",sx:{fontSize:"12px",minWidth:90,textAlign:"center"},children:e.label})]},e.id))}),!!Q&&(0,o.jsx)(l.Z,{variant:"caption",sx:{color:"#ff4444",fontSize:"11px",textAlign:"center",fontWeight:500},children:Q})]},"hover"):(0,o.jsx)(Z.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,padding:"8px",borderRadius:8},children:(0,o.jsx)(n.Z,{direction:"column",spacing:3,alignItems:"center",children:(0,o.jsx)(s.Z,{component:"div",sx:{orderRadius:"8px"},style:{cursor:"pointer"},children:(0,o.jsxs)(n.Z,{direction:"column",spacing:1,alignItems:"center",children:[(0,o.jsx)(s.Z,{component:"div",children:U||(0,o.jsx)(E.PhImage,{size:32,color:"#fff"})}),(0,o.jsx)(s.Z,{component:"div",sx:{textAlign:"center"},children:M?(0,o.jsx)(s.Z,{component:"div",sx:{color:"rgba(255, 255, 255, 0.7)",fontSize:"14px"},children:M}):(0,o.jsx)(s.Z,{component:"div",sx:{color:"rgba(255, 255, 255, 0.7)",fontSize:"14px"},children:"+ Select Visual"})})]})})})},"default")})}),(0,o.jsx)(f.ZP,{open:!!K,anchorEl:K,onClose:ev,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},slotProps:{paper:{sx:{mt:.5,boxShadow:"0px 4px 20px rgba(0, 0, 0, 0.1)",minWidth:120}}},disableScrollLock:!0,children:(0,o.jsx)(b.Z,{sx:{p:0},children:null==B?void 0:null===(r=B.subOptions)||void 0===r?void 0:r.map(e=>(0,o.jsxs)(y.Z,{onClick:r=>eg(e,r),sx:{py:1,px:2,"&:hover":{backgroundColor:e=>e.palette.Colors.Gray["100"]}},children:[(0,o.jsx)(j.Z,{children:(0,o.jsx)(e.icon,{size:18})}),(0,o.jsx)(C.Z,{primary:e.label,primaryTypographyProps:{fontSize:14}})]},e.id))})}),(0,o.jsx)("input",{ref:ei,type:"file",accept:"image/*",onChange:ef,style:{display:"none"}})]})}var F=t(8740),U=t(48321),M=t(1063),O=t(22339),W=t(38218),G=t(80560),V=t(19005),A=t(46973),N=t(21964),H=t(10986);let K=()=>{let{enqueueSnackbar:e}=(0,H.Ds)();return(0,N.D)({mutationFn:async e=>{let r=U.P.safeParse(e);if(!r.success)throw Error(`Validation failed: ${r.error.errors.map(e=>e.message).join(", ")}`);return(await A.ZP.post("/replace-character/create",r.data,{headers:{"Content-Type":"application/json"}})).data},onSuccess:e=>{},onError:r=>{var t;let o="Failed to create replace character video";(null===(t=r.response)||void 0===t?void 0:t.data)&&"object"==typeof r.response.data?o=r.response.data.error||r.message:r.message&&(o=r.message),e(o,{variant:"error"}),console.error("Failed to create replace character video:",r)}})};var $=t(86547),B=t(75616),X=t(16585),Q=t(77379),Y=t(54022),q=t(79705);async function J(e){return new Promise(r=>{try{let t=document.createElement("video");t.preload="metadata",t.crossOrigin="anonymous",t.addEventListener("loadedmetadata",()=>{r({width:t.videoWidth,height:t.videoHeight})}),t.addEventListener("error",()=>{r(null)}),t.src=e}catch(e){console.error("Failed to get video dimensions:",e),r(null)}})}let ee=e=>{let{value:r,onChange:t,extendFiledValues:a,label:i}=e,[n,c]=(0,u.useState)(!1),{upload_image_url:d,width:p,height:h}=a,[m,x]=(0,u.useState)(r||""),[v,f]=(0,u.useState)(null),[b,y]=(0,u.useState)(!1),[j,C]=(0,u.useState)(null);(0,u.useEffect)(()=>{x(r||"")},[r]),(0,u.useEffect)(()=>{d&&(p&&h?C({width:p,height:h}):J(d).then(C))},[d,p,h]);let w=()=>{c(!0)};return(0,o.jsxs)("div",{className:"mt-4",children:[d&&d.trim()?(0,o.jsxs)(s.Z,{sx:{position:"relative",width:"100%",aspectRatio:"16/9",borderWidth:"1px",borderStyle:"dashed",borderColor:"rgba(255, 255, 255, 0.1)",borderRadius:"8px",overflow:"hidden",cursor:"pointer","&:hover":{borderColor:"rgba(255, 255, 255, 0.2)","& .mask-button":{opacity:1}}},onClick:w,children:[m&&(0,o.jsx)(s.Z,{sx:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundImage:`url(${m})`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"}}),(0,o.jsx)(s.Z,{className:"mask-button",sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",opacity:.5,transition:"opacity 0.2s ease",zIndex:10,"&:hover":{opacity:1}},children:(0,o.jsx)(Q.Z,{variant:"contained",onClick:e=>{e.stopPropagation(),w()},sx:{backgroundColor:"rgb(32, 33, 35)",color:"rgba(255, 255, 255, 0.9)","&:hover":{backgroundColor:"rgb(45, 46, 48)"}},children:m?"Edit Mask":i||"Paint the area to remove"})})]}):(0,o.jsx)(s.Z,{sx:{backgroundColor:"rgb(32, 33, 35)",borderRadius:"8px",padding:"12px 16px",color:"rgba(255, 255, 255, 0.7)",fontSize:"14px",textAlign:"center",border:"1px solid rgba(255, 255, 255, 0.1)"},children:"Please upload an image first"}),v?(0,o.jsx)(l.Z,{color:"error",sx:{mt:1,fontSize:"14px",textAlign:"center"},children:v}):null,d?(0,o.jsxs)(s.Z,{sx:{position:"relative"},children:[n&&(0,o.jsx)(g.Z,{onClick:()=>c(!1),sx:{position:"fixed",right:16,top:16,zIndex:1400,backgroundColor:"rgba(0, 0, 0, 0.5)",color:"rgba(255, 255, 255, 0.9)","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"}},children:(0,o.jsx)(Y.default,{})}),(0,o.jsx)(q.x,{isOpen:n,onClose:()=>c(!1),uploadImageUrl:d,onSave:e=>{try{x(e),t(e),c(!1),f(null)}catch(e){console.error("Error saving mask URL:",e),f("Failed to save mask. Please try again.")}}})]}):null]})};var er=t(45308);let et="openart-replace-character",eo={"replace-character":{title:"Replace Character",description:"Swap a person in your video while keeping motion and background",supportMediaTypes:["image","video"]}};function ea(e){let{mode:r,...t}=e,{type:a}=t,{title:i,description:p,supportMediaTypes:h=[]}=eo[a]||{},{content:m,visual:x,selectedModel:g,resolution:v,setResolution:f,setSelectedModel:b,setContent:y,clearContent:j,setVisual:C,clearVisual:w,replaceType:k,setReplaceType:Z,prompt:S,setPrompt:R,currentFrameUrl:P,currentFrameTime:z,maskImageUrl:I,setCurrentFrame:_,setMaskImageUrl:D}=(0,M.Ge)(),T=g&&U.g[g]?{mediaType:"image",supportDescription:U.g[g].supportDescription,minImageSize:U.g[g].maxImageSize,maxImageSize:U.g[g].maxImageSize,acceptedImageTypes:U.g[g].acceptedImageTypes}:void 0,{addMockingGeneration:A,removeMockingGenerationByRequestId:N,updateResourceIdByRequestId:Q}=(0,$.F)(),Y=(0,B.NL)(),q=K(),{enqueueSnackbar:J}=(0,H.Ds)(),ea=(null==x?void 0:x.url)&&(null==m?void 0:m.url)&&g&&!q.isLoading&&("mask"!==k||I),ei=(e,r,t,o)=>{t&&(y({id:`${Date.now()}`,url:t,name:(null==o?void 0:o.name)||"Uploaded Video",type:e,duration:null==o?void 0:o.duration}),_(null,null),D(null))},en=async(e,r,t,o)=>{t&&C({id:`${Date.now()}`,url:t,name:o||"Uploaded Image",type:"image",description:o})},el=x?{id:x.id,url:x.url,name:x.name,type:x.type,characterId:x.characterId,description:x.description}:void 0;(0,u.useEffect)(()=>{b(et)},[]);let es=async()=>{if(!g){console.error("No model selected");return}let e={characterUrl:(null==x?void 0:x.url)||"",characterType:null==x?void 0:x.type,sourceVideoUrl:(null==m?void 0:m.url)||"",sourceVideoType:"video",model:g,prompt:S,resolution:v,maskImageUrl:"mask"===k?I:null,replaceType:k},r=U.P.safeParse(e);if(!r.success){J(r.error.errors.map(e=>e.message).join(", ")||"Invalid parameters",{variant:"error"});return}let t=A({turbo_mode:"normal"});try{let r=await q.mutateAsync(e);Q(t,[r.generation_media_resource_id]),await Y.invalidateQueries([V.uE]),await Y.invalidateQueries({queryKey:["useGenerationHistories"],exact:!1}),(0,X.B)("asset_created",{creation_source:"replace-character",image_num:1,credits_num:ec||0,model_name:g,page_type:a})}catch(e){console.error("Creation failed:",e),N(t)}},ec=(0,u.useMemo)(()=>{if(!g)return 0;let e=U.g[g];if(e){let r=e.featureKeys;return(0,W.du)(r,r.reduce((e,r)=>(e[r]=(0,G.dC)((null==m?void 0:m.duration)??0),e),{}),(0,G.Ks)({model:g,featureKeys:r,resolution:v,modeType:k}))}return 0},[g,null==m?void 0:m.duration,v,k]),ed=(0,u.useCallback)((e,r)=>{"mask"===k&&_(e,r)},[k,_]),ep="mask"===k&&(null==m?void 0:m.url),eu=(0,u.useRef)(null);return(0,u.useEffect)(()=>{if("mask"===k&&(null==m?void 0:m.url)&&!P){let e=setTimeout(()=>{var e;null===(e=eu.current)||void 0===e||e.extractFrame()},200);return()=>clearTimeout(e)}},[k,null==m?void 0:m.url,P]),(0,o.jsxs)(n.Z,{direction:"column",spacing:2,sx:{position:"relative",height:"100%",py:1.5,px:.5,color:"white"},children:[(0,o.jsxs)(n.Z,{direction:"row",alignItems:"center",justifyContent:"space-between",sx:{pb:2,borderBottom:"1px solid",borderColor:e=>e.palette.Colors.Gray["200"]},children:[(0,o.jsx)(l.Z,{variant:"h6",fontWeight:600,sx:{color:"white",fontSize:"18px"},children:i}),(0,o.jsx)(F.oK,{handleTryExample:()=>{en("image","example","https://cdn.openart.ai/assets/internal/uploads/image_H1c-TLjj_1024x1024_1758183262519.webp"),ei("video","example","https://cdn.openart.ai/production/2025-09/uploads/nIp59rPDHPc0MRaW2DWt/file_bSbZwbKE_1758183189132.mp4",{duration:11,name:"Example Video"}),b(et)}})]}),(0,o.jsxs)(s.Z,{sx:{flex:"1 1 auto",overflowY:"auto",overflowX:"hidden"},children:[(0,o.jsx)(l.Z,{component:"div",variant:"subtitle1",fontWeight:600,sx:{color:"white",fontSize:"14px",mb:1},children:"Model"}),(0,o.jsx)(er.o,{value:g,onChange:b,supportMediaTypes:h,modelOptions:U.g}),(0,o.jsxs)(n.Z,{spacing:1,sx:{p:1,mb:2,borderRadius:1,border:"1px solid",borderColor:e=>e.palette.Colors.Gray["200"]},children:[(0,o.jsx)(l.Z,{component:"div",variant:"subtitle1",fontWeight:600,sx:{color:"white",fontSize:"16px",mb:1},children:"1. Which Video Do You Want To Edit?"}),(0,o.jsx)(d.u,{ref:eu,content:m,modelConfig:g?U.g[g]:void 0,cdnFolder:"video/replace-character",onSelectSource:ei,onRemove:j,onFrameExtract:(null==m?void 0:m.url)?ed:void 0,videoIcon:(0,o.jsx)(E.PhVideoCamera,{size:36,color:"#fff",sx:{opacity:.6}}),contentText:"Upload Character Video"}),(null==m?void 0:m.url)&&(0,o.jsx)(F.Q0,{value:k,setValue:Z,options:M.id,border:!1,columnsPerRow:3}),ep&&P&&(0,o.jsx)(ee,{value:I,onChange:e=>{D(e)},extendFiledValues:{upload_image_url:P},label:"Draw Mask"})]}),(0,o.jsx)(s.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",my:2},children:(0,o.jsx)(c,{sx:{color:e=>e.palette.Colors.Gray["500"],opacity:.6}})}),(0,o.jsxs)(n.Z,{spacing:1,sx:{p:1,mb:2,borderRadius:1,border:"1px solid",borderColor:e=>e.palette.Colors.Gray["200"]},children:[(0,o.jsx)(l.Z,{component:"div",variant:"subtitle1",fontWeight:600,sx:{color:"white",fontSize:"16px",mb:1},children:"2. Choose Your Replacement Character"}),(0,o.jsx)(L,{visual:el,modelConfig:T,isProcessingVisual:!1,cdnFolder:"video/replace-character",onSelectSource:en,onRemove:()=>{w()},onDescriptionChange:e=>{x&&C({...x,description:e})},imageIcon:(0,o.jsx)(E.PhSmiley,{size:36,color:"#fff",sx:{opacity:.6}}),contentText:"Select Character"})]}),(0,o.jsx)(F.H_,{label:"Resolution",resolution:v,setResolution:f,resolutions:[720,1080],border:!1,fontSize:"14px"}),(0,o.jsx)(F.I5,{prompt:S,setPrompt:R,label:"Prompt (optional)",placeholder:"Describe how the character should move",border:!1,fontSize:"14px"})]}),(0,o.jsx)(O.X,{loading:q.isLoading,disabled:!ea,costCredits:ec,onClick:es})]})}var ei=t(92744),en=t(60503),el=t(31695),es=t(35023),ec=t(38447),ed=t(64134),ep=!0;function eu(e){return(0,o.jsx)(a.a,{value:i.V.VIDEO_REPLACE_CHARACTER,children:(0,o.jsxs)(ed.g,{ogConfig:es.oO,children:[(0,o.jsx)(en._,{width:"370px",title:"Replace Character",serverProps:e,Sidebar:ea,sidebarProps:{type:"replace-character"}}),(0,o.jsx)(ei.Z,{serverProps:e,renderMainContent:el.L})]})})}eu.getLayout=(e,r)=>(0,o.jsx)(ec.$,{...r,children:e})}},function(e){e.O(0,[4354,4164,9686,9551,3262,4216,2088,7326,3003,5065,1278,9474,416,2004,1406,3343,3680,5966,669,6380,6478,3173,9705,2888,9774,179],function(){return e(e.s=102)}),_N_E=e.O()}]);